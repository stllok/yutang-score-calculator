import{s as Le,n as Ee}from"../chunks/scheduler.CtbWrGNo.js";import{S as Me,i as Pe,e as x,s as V,t as I,c as w,a as C,d as v,f as k,b as D,y as Fe,o as b,z as F,g as fe,h as T,A as je,B as He,j as le,C as Ie}from"../chunks/index.BoMExaJv.js";function re(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}const L="Team 1",M="Worthless Team",P="no idea",j="Team 4",H="牛奶咖喱營多印尼炒麵",N="Team 6",R="Team 7",B="Team 8",J="Team 9",K="武当派: 亚洲传奇",W="Team 11",q="Team 12",z="Team 13",G="Team 14",Z="Team 15",Q="Team 16",Ne={10056419:{team:L,T:0},10170668:{team:L,T:0},12585858:{team:L,T:1},3825470:{team:L,T:1},11113661:{team:L,T:2},7083079:{team:L,T:2},7407702:{team:L,T:3},22690359:{team:L,T:3},8802914:{team:M,T:0},2848604:{team:M,T:0},4137401:{team:M,T:1},12941954:{team:M,T:1},9043058:{team:M,T:2},17896085:{team:M,T:2},11444694:{team:M,T:3},13858681:{team:M,T:3},15816872:{team:P,T:0},9138046:{team:P,T:0},10516802:{team:P,T:1},15100415:{team:P,T:1},10500832:{team:P,T:2},9314367:{team:P,T:2},20971891:{team:P,T:3},17522180:{team:P,T:3},13207763:{team:j,T:0},14447878:{team:j,T:0},14726718:{team:j,T:1},8893772:{team:j,T:1},9082441:{team:j,T:2},15184992:{team:j,T:2},8947019:{team:j,T:3},13437541:{team:j,T:3},11307733:{team:H,T:0},17636394:{team:H,T:0},20988374:{team:H,T:1},9321674:{team:H,T:1},4335279:{team:H,T:2},14533605:{team:H,T:2},14129921:{team:H,T:3},3094900:{team:H,T:3},11443437:{team:N,T:0},2984074:{team:N,T:0},9317938:{team:N,T:1},17663666:{team:N,T:1},5179557:{team:N,T:2},1855908:{team:N,T:2},24232404:{team:N,T:3},7945343:{team:N,T:3},2165650:{team:R,T:0},12652779:{team:R,T:0},7457788:{team:R,T:1},16069829:{team:R,T:1},1026006:{team:R,T:2},3339073:{team:R,T:2},874891:{team:R,T:3},5936405:{team:R,T:3},11129034:{team:B,T:0},12566632:{team:B,T:0},6433183:{team:B,T:1},6338477:{team:B,T:1},6537257:{team:B,T:2},9586445:{team:B,T:2},15044350:{team:B,T:3},21573458:{team:B,T:3},5413624:{team:J,T:0},10592853:{team:J,T:0},16318993:{team:J,T:1},7852852:{team:J,T:1},14800198:{team:J,T:2},10458474:{team:J,T:2},3917377:{team:J,T:3},9164371:{team:J,T:3},8359561:{team:K,T:0},6916642:{team:K,T:0},757783:{team:K,T:1},1433427:{team:K,T:1},14942888:{team:K,T:2},18321104:{team:K,T:2},10436444:{team:K,T:3},13795588:{team:K,T:3},4659319:{team:W,T:0},12585048:{team:W,T:0},19577872:{team:W,T:1},2165622:{team:W,T:1},7825227:{team:W,T:2},3367476:{team:W,T:2},9218431:{team:W,T:3},16129812:{team:W,T:3},11375105:{team:q,T:0},1355695:{team:q,T:0},8194992:{team:q,T:1},6763434:{team:q,T:1},28290392:{team:q,T:2},18212788:{team:q,T:2},11611550:{team:q,T:3},29220430:{team:q,T:3},4896825:{team:z,T:0},5242158:{team:z,T:0},8688737:{team:z,T:1},9507565:{team:z,T:1},10625776:{team:z,T:2},16288992:{team:z,T:2},11396041:{team:z,T:3},8281276:{team:z,T:3},7813296:{team:G,T:0},10634348:{team:G,T:0},9547561:{team:G,T:1},6747917:{team:G,T:1},4075655:{team:G,T:2},25175502:{team:G,T:2},20660835:{team:G,T:3},11134301:{team:G,T:3},3898396:{team:Z,T:0},8926244:{team:Z,T:0},7172340:{team:Z,T:1},1766764:{team:Z,T:1},1775182:{team:Z,T:2},4113311:{team:Z,T:2},17163162:{team:Z,T:3},18901419:{team:Z,T:3},8799923:{team:Q,T:0},114017:{team:Q,T:0},12270069:{team:Q,T:1},15030466:{team:Q,T:1},24323283:{team:Q,T:2},11412507:{team:Q,T:2},8535398:{team:Q,T:3},3538079:{team:Q,T:3}};function Ce(s,e,a){const m=s.slice();return m[9]=e[a],m}function De(s,e,a){const m=s.slice();return m[9]=e[a],m}function Se(s){let e,a=s[9]+"",m,r;return{c(){e=x("p"),m=I(a),r=V(),this.h()},l(n){e=w(n,"P",{class:!0});var c=C(e);m=D(c,a),r=k(c),c.forEach(v),this.h()},h(){b(e,"class","text-white first:text-8xl last:text-5xl [&:nth-child(2)]:text-7xl [&:nth-child(3)]:text-6xl")},m(n,c){fe(n,e,c),T(e,m),T(e,r)},p(n,c){c&1&&a!==(a=n[9]+"")&&le(m,a)},d(n){n&&v(e)}}}function Ve(s){let e,a=s[9]+"",m,r;return{c(){e=x("p"),m=I(a),r=V(),this.h()},l(n){e=w(n,"P",{class:!0});var c=C(e);m=D(c,a),r=k(c),c.forEach(v),this.h()},h(){b(e,"class","text-white first:text-8xl last:text-5xl [&:nth-child(2)]:text-7xl [&:nth-child(3)]:text-6xl")},m(n,c){fe(n,e,c),T(e,m),T(e,r)},p(n,c){c&1&&a!==(a=n[9]+"")&&le(m,a)},d(n){n&&v(e)}}}function ke(s){let e,a='<p class="text-9xl">ACC MODE</p>';return{c(){e=x("div"),e.innerHTML=a,this.h()},l(m){e=w(m,"DIV",{class:!0,"data-svelte-h":!0}),Fe(e)!=="svelte-1txw6kb"&&(e.innerHTML=a),this.h()},h(){b(e,"class","flex justify-center mb-5")},m(m,r){fe(m,e,r)},d(m){m&&v(e)}}}function Re(s){let e,a,m,r,n,c,U=(s[2][0]/4).toFixed(2)+"",E,se,me,p,u=s[1][0]+"",d,ee,i,X="VS",Y,g,S=s[1][1]+"",Te,he,A,ue,ne=(s[2][1]/4).toFixed(2)+"",ce,de,_e,$,ve,ge,pe,te=re(s[0][0]),f=[];for(let l=0;l<te.length;l+=1)f[l]=Se(De(s,te,l));let ae=re(s[0][1]),h=[];for(let l=0;l<ae.length;l+=1)h[l]=Ve(Ce(s,ae,l));let _=s[3]&&ke();return{c(){e=x("div"),a=x("div"),m=x("div");for(let l=0;l<f.length;l+=1)f[l].c();r=V(),n=x("div"),c=I("(acc: "),E=I(U),se=I(")"),me=V(),p=x("div"),d=I(u),ee=V(),i=x("p"),i.textContent=X,Y=V(),g=x("div"),Te=I(S),he=V(),A=x("div"),ue=I("(acc: "),ce=I(ne),de=I(")"),_e=V(),$=x("div");for(let l=0;l<h.length;l+=1)h[l].c();ve=V(),_&&_.c(),this.h()},l(l){e=w(l,"DIV",{class:!0});var o=C(e);a=w(o,"DIV",{class:!0});var t=C(a);m=w(t,"DIV",{class:!0});var O=C(m);for(let y=0;y<f.length;y+=1)f[y].l(O);O.forEach(v),r=k(t),n=w(t,"DIV",{class:!0});var ie=C(n);c=D(ie,"(acc: "),E=D(ie,U),se=D(ie,")"),ie.forEach(v),me=k(t),p=w(t,"DIV",{class:!0});var xe=C(p);d=D(xe,u),xe.forEach(v),ee=k(t),i=w(t,"P",{class:!0,"data-svelte-h":!0}),Fe(i)!=="svelte-ob87o3"&&(i.textContent=X),Y=k(t),g=w(t,"DIV",{class:!0});var we=C(g);Te=D(we,S),we.forEach(v),he=k(t),A=w(t,"DIV",{class:!0});var oe=C(A);ue=D(oe,"(acc: "),ce=D(oe,ne),de=D(oe,")"),oe.forEach(v),_e=k(t),$=w(t,"DIV",{class:!0});var be=C($);for(let y=0;y<h.length;y+=1)h[y].l(be);be.forEach(v),t.forEach(v),ve=k(o),_&&_.l(o),o.forEach(v),this.h()},h(){b(m,"class","flex flex-row-reverse items-center gap-5"),b(n,"class","text-3xl text-white"),b(p,"class","text-6xl text-white svelte-1kdf3em"),F(p,"winner",s[1][0]>s[1][1]),F(p,"loser",s[1][1]>s[1][0]),b(i,"class","text-4xl text-white"),b(g,"class","text-6xl text-white svelte-1kdf3em"),F(g,"winner",s[1][1]>s[1][0]),F(g,"loser",s[1][0]>s[1][1]),b(A,"class","text-3xl text-white"),b($,"class","flex flex-row items-center gap-5"),b(a,"class","flex items-center justify-between p-5"),b(e,"class","flex h-screen w-screen flex-col justify-between")},m(l,o){fe(l,e,o),T(e,a),T(a,m);for(let t=0;t<f.length;t+=1)f[t]&&f[t].m(m,null);T(a,r),T(a,n),T(n,c),T(n,E),T(n,se),T(a,me),T(a,p),T(p,d),T(a,ee),T(a,i),T(a,Y),T(a,g),T(g,Te),T(a,he),T(a,A),T(A,ue),T(A,ce),T(A,de),T(a,_e),T(a,$);for(let t=0;t<h.length;t+=1)h[t]&&h[t].m($,null);T(e,ve),_&&_.m(e,null),ge||(pe=je(window,"keydown",He(s[4])),ge=!0)},p(l,[o]){if(o&1){te=re(l[0][0]);let t;for(t=0;t<te.length;t+=1){const O=De(l,te,t);f[t]?f[t].p(O,o):(f[t]=Se(O),f[t].c(),f[t].m(m,null))}for(;t<f.length;t+=1)f[t].d(1);f.length=te.length}if(o&4&&U!==(U=(l[2][0]/4).toFixed(2)+"")&&le(E,U),o&2&&u!==(u=l[1][0]+"")&&le(d,u),o&2&&F(p,"winner",l[1][0]>l[1][1]),o&2&&F(p,"loser",l[1][1]>l[1][0]),o&2&&S!==(S=l[1][1]+"")&&le(Te,S),o&2&&F(g,"winner",l[1][1]>l[1][0]),o&2&&F(g,"loser",l[1][0]>l[1][1]),o&4&&ne!==(ne=(l[2][1]/4).toFixed(2)+"")&&le(ce,ne),o&1){ae=re(l[0][1]);let t;for(t=0;t<ae.length;t+=1){const O=Ce(l,ae,t);h[t]?h[t].p(O,o):(h[t]=Ve(O),h[t].c(),h[t].m($,null))}for(;t<h.length;t+=1)h[t].d(1);h.length=ae.length}l[3]?_||(_=ke(),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},i:Ee,o:Ee,d(l){l&&v(e),Ie(f,l),Ie(h,l),_&&_.d(),ge=!1,pe()}}}function Be(s,e){return e.match("EZ")!==null?s*1.75:s}function Ae(s,e){return e.score-s.score}function Oe(s,e){return e.acc-s.acc}function Je(s,e,a){let m=[[0,0,0,0],[0,0,0,0]],r=[0,0],n=[0,0];const c=[10,7,5,3,1],U=new WebSocket("ws://127.0.0.1:24050/ws");let E=!1;function se(u){switch(u.key){case"t":a(3,E=!E);break}}function me(u,d){return c[d]>c[u]?c[u]+(c[d]-c[u])*.5:c[d]}function p(u,d){return!E&&d!==void 0&&!u.bonus_score_flag&&u.score>2*d.score?(d.bonus_score_flag=!0,!0):!1}return U.addEventListener("message",u=>{let d=JSON.parse(u.data).tourney.ipcClients;if(d.find(i=>i.spectating.userID===0)!==void 0)return;let ee=d.map((i,X)=>({team:X<4?0:1,id:i.spectating.userID,score:Be(i.gameplay.score,i.gameplay.mods.str),tier:Ne[i.spectating.userID].T,acc:i.gameplay.accuracy,bonus_score_flag:!1})).sort(E?Oe:Ae);a(2,n=[0,0]),a(1,r=[0,0]),ee.forEach(i=>{const X=ee.filter(S=>S.team!=i.team),Y=X.findIndex(S=>(E?Oe:Ae)(i,S)<0),g=me(i.tier,Y===-1?4:Y)+(p(i,X[Y+1])?.5:0);a(0,m[i.team][i.tier]=g,m),a(2,n[i.team]+=i.acc,n),a(1,r[i.team]+=g,r)})}),[m,r,n,E,se]}class qe extends Me{constructor(e){super(),Pe(this,e,Je,Re,Le,{})}}export{qe as component};
